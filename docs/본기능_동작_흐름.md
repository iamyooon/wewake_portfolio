# 3-AI 포트폴리오 보고서 본기능 동작 흐름

## 왜 몇 분 걸리나?

**AI API를 순서대로 4번** 호출하기 때문입니다. 각 호출이 30초~2분 정도 걸리고, **전부 동기(순차)** 로 실행됩니다.

---

## 단계별 흐름 (6단계)

```
[1/6] 환경 변수 로드        (.env에서 API 키 읽기)           → 즉시
[2/6] 프롬프트 파일 읽기    (portfolio_prompt.txt)          → 즉시

[3/6] OpenAI · 초안 작성    포트폴리오 지시문 → 전체 보고서 초안   → 1~2분
[4/6] Grok · 리뷰           초안 → 정확성/완성도/개선 코멘트      → 30초~1분
[5/6] Gemini · 검증         초안+리뷰 → 수치/데이터 검증 결과     → 30초~1분
[6/6] OpenAI · 최종 작성    초안+리뷰+검증 → 최종 보고서          → 1~2분

      → 마크다운 파일 저장 + 모델 사용 현황 출력
```

---

## 각 단계가 하는 일

| 단계 | AI | 입력 | 출력 | 대략 소요 |
|------|-----|------|------|------------|
| 3/6 | **OpenAI** | `portfolio_prompt.txt` 전체 + “어제 기준으로 보고서 써라” 지시 | **초안 보고서** (목표, 마켓 현황, 자산표, 로드맵, 코멘트 등) | 1~2분 |
| 4/6 | **Grok** | 초안 전문 + “리뷰해줘” 지시 | **리뷰 코멘트** (강점, 개선점, 추가 제안) | 30초~1분 |
| 5/6 | **Gemini** | 초안 + 리뷰 + 포트폴리오 원문 | **검증 결과** (수치 검증, 오류/수정 제안) | 30초~1분 |
| 6/6 | **OpenAI** | 초안 + 리뷰 + 검증 결과 + “이걸 반영해서 최종 보고서 써라” | **최종 보고서** (한 개 마크다운) | 1~2분 |

- **3/6, 6/6**이 가장 무겁습니다. 긴 프롬프트 + 긴 생성(보고서 전체)이라 1~2분씩 걸립니다.
- **4/6, 5/6**은 상대적으로 짧지만, 입력 텍스트가 길어서 30초~1분 정도 걸립니다.

---

## 요약

- **본기능 = AI 호출 4번** (OpenAI 2번, Grok 1번, Gemini 1번)을 **한 번에 순서대로** 실행합니다.
- 테스트(`--test-models`)는 각 AI에 짧은 문장 한 번만 보내서 10~20초 안에 끝나고,
- 본기능은 **긴 초안 → 리뷰 → 검증 → 긴 최종본**까지 만들어서 **총 3~5분** 정도 걸리는 구조입니다.
